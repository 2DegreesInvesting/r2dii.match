<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>r2dii.match • r2dii.match</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="r2dii.match">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2dii.match</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/r2dii.match.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maurolepore">
    <span class="fa fa-gavel"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/2DegreesInvesting/r2dii.match">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>r2dii.match</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/2DegreesInvesting/r2dii.match/blob/master/vignettes/r2dii.match.Rmd"><code>vignettes/r2dii.match.Rmd</code></a></small>
      <div class="hidden name"><code>r2dii.match.Rmd</code></div>

    </div>

    
    
<p>This example aims to show the entire matching process. As usual, we start by using required packages. For convenience we’ll also use dplyr.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(r2dii.match)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(r2dii.dataraw)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: r2dii.utils</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a></code></pre></div>
<p>We’ll use some fake datasets from the r2dii.dataraw package, which name ends with <code>_demo</code>, for example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">loanbook_demo</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; # A tibble: 320 x 19</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;    id_loan id_direct_loant… name_direct_loa… id_intermediate… name_intermedia…</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;  1 L1      C294             Yuamen Xinneng … &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  2 L2      C293             Yuamen Changyua… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  3 L3      C292             Yuama Ethanol L… IP5              Yuama Inc.      </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  4 L4      C299             Yudaksel Holdin… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  5 L5      C305             Yukon Energy Co… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  6 L6      C304             Yukon Developme… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  7 L7      C227             Yaugoa-Zapadnay… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  8 L8      C303             Yueyang City Co… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;  9 L9      C301             Yuedxiu Corp One IP10             Yuedxiu Group   </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; 10 L10     C302             Yuexi County AA… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; # … with 310 more rows, and 14 more variables: id_ultimate_parent &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; #   name_ultimate_parent &lt;chr&gt;, loan_size_outstanding &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; #   loan_size_outstanding_currency &lt;chr&gt;, loan_size_credit_limit &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; #   loan_size_credit_limit_currency &lt;chr&gt;, sector_classification_system &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; #   sector_classification_input_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; #   sector_classification_direct_loantaker &lt;dbl&gt;, fi_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; #   flag_project_finance_loan &lt;chr&gt;, name_project &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; #   lei_direct_loantaker &lt;lgl&gt;, isin_direct_loantaker &lt;lgl&gt;</span></a></code></pre></div>
<p>Before matching, both the loanbook and asset level data must be prepared. To this end, there are several mandatory steps, and several optional steps.</p>
<p>We can bridge from multiple sector classification codes to 2Dii’s sectors: automotive, aviation, cement, oil and gas, power, shipping, steel.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">loanbook_demo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/bridge_sector.html">bridge_sector</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="co"># Focusing on columns related to sector</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    sector_classification_system,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    sector_classification_input_type,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">    sector_classification_direct_loantaker,</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">    sector,</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    borderline</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  )</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; # A tibble: 320 x 5</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;    sector_classificat… sector_classificat… sector_classificat… sector borderline</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;    &lt;chr&gt;               &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;  &lt;lgl&gt;     </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  1 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;  2 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;  3 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  4 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;  5 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;  6 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;  7 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;  8 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;  9 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; 10 NACE                Code                               3511 power  TRUE      </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; # … with 310 more rows</span></a></code></pre></div>
<p>In case the loanbook has non-unique IDs, can generate name+sector specific IDs (this is especially important if one company is classified in two sectors for two loans).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">loanbook_demo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st"> </span><span class="kw"><a href="../reference/uniquify_id_column.html">uniquify_id_column</a></span>(<span class="dt">id_column =</span> <span class="st">"id_direct_loantaker"</span>, <span class="dt">prefix =</span> <span class="st">"C"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; # A tibble: 320 x 19</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;    id_loan id_direct_loant… name_direct_loa… id_intermediate… name_intermedia…</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;  1 L1      C294             Yuamen Xinneng … &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  2 L2      C293             Yuamen Changyua… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  3 L3      C292             Yuama Ethanol L… IP5              Yuama Inc.      </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  4 L4      C299             Yudaksel Holdin… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  5 L5      C305             Yukon Energy Co… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  6 L6      C304             Yukon Developme… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  7 L7      C227             Yaugoa-Zapadnay… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  8 L8      C303             Yueyang City Co… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  9 L9      C301             Yuedxiu Corp One IP10             Yuedxiu Group   </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 10 L10     C302             Yuexi County AA… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; # … with 310 more rows, and 14 more variables: id_ultimate_parent &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; #   name_ultimate_parent &lt;chr&gt;, loan_size_outstanding &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; #   loan_size_outstanding_currency &lt;chr&gt;, loan_size_credit_limit &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; #   loan_size_credit_limit_currency &lt;chr&gt;, sector_classification_system &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; #   sector_classification_input_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; #   sector_classification_direct_loantaker &lt;dbl&gt;, fi_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; #   flag_project_finance_loan &lt;chr&gt;, name_project &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; #   lei_direct_loantaker &lt;lgl&gt;, isin_direct_loantaker &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"></a>
<a class="sourceLine" id="cb4-25" data-line-number="25">loanbook_demo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="st"> </span><span class="kw"><a href="../reference/uniquify_id_column.html">uniquify_id_column</a></span>(<span class="dt">id_column =</span> <span class="st">"id_ultimate_parent"</span>, <span class="dt">prefix =</span> <span class="st">"UP"</span>)</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; # A tibble: 320 x 19</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;    id_loan id_direct_loant… name_direct_loa… id_intermediate… name_intermedia…</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt;  1 L1      C294             Yuamen Xinneng … &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt;  2 L2      C293             Yuamen Changyua… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;  3 L3      C292             Yuama Ethanol L… IP5              Yuama Inc.      </span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;  4 L4      C299             Yudaksel Holdin… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt;  5 L5      C305             Yukon Energy Co… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt;  6 L6      C304             Yukon Developme… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt;  7 L7      C227             Yaugoa-Zapadnay… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt;  8 L8      C303             Yueyang City Co… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt;  9 L9      C301             Yuedxiu Corp One IP10             Yuedxiu Group   </span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; 10 L10     C302             Yuexi County AA… &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="co">#&gt; # … with 310 more rows, and 14 more variables: id_ultimate_parent &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt; #   name_ultimate_parent &lt;chr&gt;, loan_size_outstanding &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt; #   loan_size_outstanding_currency &lt;chr&gt;, loan_size_credit_limit &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co">#&gt; #   loan_size_credit_limit_currency &lt;chr&gt;, sector_classification_system &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt; #   sector_classification_input_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt; #   sector_classification_direct_loantaker &lt;dbl&gt;, fi_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co">#&gt; #   flag_project_finance_loan &lt;chr&gt;, name_project &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt; #   lei_direct_loantaker &lt;lgl&gt;, isin_direct_loantaker &lt;lgl&gt;</span></a></code></pre></div>
<p>Before we run the fuzzy matching algorithm, we simplify the loanbook and ald names using:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">some_customer_names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"3M Company"</span>, <span class="st">"Abbott Laboratories"</span>, <span class="st">"AbbVie Inc."</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="../reference/replace_customer_name.html">replace_customer_name</a></span>(some_customer_names)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; [1] "threem co"          "abbottlaboratories" "abbvie inc"</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># replacements can be defined from scratch using:</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">custom_replacement &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(<span class="dt">from =</span> <span class="st">"AAAA"</span>, <span class="dt">to =</span> <span class="st">"B"</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="../reference/replace_customer_name.html">replace_customer_name</a></span>(<span class="st">"Aa Aaaa"</span>, <span class="dt">from_to =</span> custom_replacement)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] "aab"</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># or appended to the existing list of replacements:</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw"><a href="../reference/replace_customer_name.html">get_replacements</a></span>()</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; # A tibble: 61 x 2</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;    from    to   </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;  1 " and " " &amp; "</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;  2 " en "  " &amp; "</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;  3 " och " " &amp; "</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;  4 " und " " &amp; "</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt;  5 (pjsc)  ""   </span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt;  6 (pte)   ""   </span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt;  7 (pvt)   ""   </span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt;  8 0       null </span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;  9 1       one  </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; 10 2       two  </span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; # … with 51 more rows</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"></a>
<a class="sourceLine" id="cb5-27" data-line-number="27">appended_replacements &lt;-<span class="st"> </span><span class="kw"><a href="../reference/replace_customer_name.html">get_replacements</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">add_row</a></span>(</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">    <span class="dt">.before =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">    <span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AA"</span>, <span class="st">"BB"</span>), <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"alpha"</span>, <span class="st">"beta"</span>)</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">  )</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">appended_replacements</a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#&gt; # A tibble: 63 x 2</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">#&gt;    from    to   </span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="co">#&gt;  1 AA      alpha</span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="co">#&gt;  2 BB      beta </span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="co">#&gt;  3 " and " " &amp; "</span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="co">#&gt;  4 " en "  " &amp; "</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="co">#&gt;  5 " och " " &amp; "</span></a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="co">#&gt;  6 " und " " &amp; "</span></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="co">#&gt;  7 (pjsc)  ""   </span></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"><span class="co">#&gt;  8 (pte)   ""   </span></a>
<a class="sourceLine" id="cb5-44" data-line-number="44"><span class="co">#&gt;  9 (pvt)   ""   </span></a>
<a class="sourceLine" id="cb5-45" data-line-number="45"><span class="co">#&gt; 10 0       null </span></a>
<a class="sourceLine" id="cb5-46" data-line-number="46"><span class="co">#&gt; # … with 53 more rows</span></a>
<a class="sourceLine" id="cb5-47" data-line-number="47"></a>
<a class="sourceLine" id="cb5-48" data-line-number="48"><span class="co"># And in combination with `replace_customer_name()`</span></a>
<a class="sourceLine" id="cb5-49" data-line-number="49"><span class="kw"><a href="../reference/replace_customer_name.html">replace_customer_name</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AA"</span>, <span class="st">"BB"</span>, <span class="st">"1"</span>), <span class="dt">from_to =</span> appended_replacements)</a>
<a class="sourceLine" id="cb5-50" data-line-number="50"><span class="co">#&gt; [1] "alpha" "beta"  "one"</span></a></code></pre></div>
<p>The following function takes a loanbook with non-corrupt IDs and outputs a list of all unique name and sector combinations at every level, including the simplified name, to be used in the matching process:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">prep_loanbook &lt;-<span class="st"> </span>loanbook_demo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/prepare_loanbook_for_matching.html">prepare_loanbook_for_matching</a></span>()</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Warning: Uniquifying `id_direct_loantaker` &amp; `id_ultimate_parent`.</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Adding new columns `sector` and `borderline`.</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">prep_loanbook</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; # A tibble: 638 x 6</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;    level      id    name                     sector source  simpler_name        </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;                    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;               </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;  1 direct_lo… C294  Yuamen Xinneng Thermal … power  loanbo… yuamenxinnengtherma…</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;  2 ultimate_… UP15  Alpine Knits India Pvt.… power  loanbo… alpineknitsindiapvt…</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  3 direct_lo… C293  Yuamen Changyuan Hydrop… power  loanbo… yuamenchangyuanhydr…</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  4 ultimate_… UP84  Eco Wave Power           power  loanbo… ecowavepower        </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;  5 direct_lo… C292  Yuama Ethanol Llc        power  loanbo… yuamaethanol llc    </span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;  6 ultimate_… UP288 University Of Iowa       power  loanbo… universityofiowa    </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;  7 direct_lo… C299  Yudaksel Holding A.S     power  loanbo… yudakselhldgs as    </span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;  8 ultimate_… UP54  China Electric Power (F… power  loanbo… chinaelectricpowerf…</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;  9 direct_lo… C305  Yukon Energy Corp 1736   power  loanbo… yukonenergycorpones…</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; 10 ultimate_… UP104 Garland Power &amp; Light    power  loanbo… garlandpowerlight   </span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; # … with 628 more rows</span></a></code></pre></div>
<p>And similarly for the ald:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">prep_ald &lt;-<span class="st"> </span>r2dii.dataraw<span class="op">::</span>ald_demo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/prepare_ald_for_matching.html">prepare_ald_for_matching</a></span>()</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">prep_ald</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; # A tibble: 591 x 3</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;    name                             sector   simpler_name                 </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;    &lt;chr&gt;                            &lt;chr&gt;    &lt;chr&gt;                        </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  1 aba hydropower generation co ltd power    abahydropowergenco ltd       </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  2 achinsky glinoziemskij kombinat  cement   achinskyglinoziemskijkombinat</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  3 affinity renewables inc.         power    affinityrenewables inc       </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  4 africa oil corp                  oil&amp;gas  africaoil corp               </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  5 africon shipping sa              shipping africonshp sa                </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  6 agni steels private limited      power    agnisteelsprivate ltd        </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  7 agrenewables                     power    agrenewables                 </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt;  8 airasia x bhd                    aviation airasiaxbhd                  </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt;  9 airbaltic                        aviation airbaltic                    </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; 10 airblue                          aviation airblue                      </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; # … with 581 more rows</span></a></code></pre></div>
<p>For the purpose of manual matching, you can substitute the name and/ or sector of particular loans at the desired level when preparing the loanbook data. To do so, specify the <code>overwrite</code> argument in prepare_loanbook_for_matching(). (To substitute only the name, leave sector as <code>NA</code> and vice-versa).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">overwrite_demo &lt;-<span class="st"> </span>r2dii.dataraw<span class="op">::</span>overwrite_demo</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">overwrite_demo</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; # A tibble: 2 x 5</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt;   level            id    name                 sector source</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;   &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;  &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 1 direct_loantaker C294  yuamen power company coal   manual</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 2 ultimate_parent  UP15  alpine india         power  manual</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">prep_loanbook &lt;-<span class="st"> </span>loanbook_demo <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="../reference/prepare_loanbook_for_matching.html">prepare_loanbook_for_matching</a></span>(<span class="dt">overwrite =</span> overwrite_demo)</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; Warning: Uniquifying `id_direct_loantaker` &amp; `id_ultimate_parent`.</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; Adding new columns `sector` and `borderline`.</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"></a>
<a class="sourceLine" id="cb8-14" data-line-number="14">prep_loanbook</a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; # A tibble: 638 x 6</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt;    level      id    name                     sector source  simpler_name        </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;                    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;               </span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt;  1 direct_lo… C294  yuamen power company     coal   manual  yuamenpower co      </span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt;  2 ultimate_… UP15  alpine india             power  manual  alpineindia         </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt;  3 direct_lo… C293  Yuamen Changyuan Hydrop… power  loanbo… yuamenchangyuanhydr…</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt;  4 ultimate_… UP84  Eco Wave Power           power  loanbo… ecowavepower        </span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt;  5 direct_lo… C292  Yuama Ethanol Llc        power  loanbo… yuamaethanol llc    </span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt;  6 ultimate_… UP288 University Of Iowa       power  loanbo… universityofiowa    </span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt;  7 direct_lo… C299  Yudaksel Holding A.S     power  loanbo… yudakselhldgs as    </span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt;  8 ultimate_… UP54  China Electric Power (F… power  loanbo… chinaelectricpowerf…</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt;  9 direct_lo… C305  Yukon Energy Corp 1736   power  loanbo… yukonenergycorpones…</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; 10 ultimate_… UP104 Garland Power &amp; Light    power  loanbo… garlandpowerlight   </span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; # … with 628 more rows</span></a></code></pre></div>
<p><code><a href="../reference/match_all_against_all.html">match_all_against_all()</a></code> scores the similarity between <code>simpler_name</code> values in the prepared loanbook and ald datasets. The <code>by_sector</code> argument, flags if names should only be compared against ald names in the same sector. (setting <code>by_sector = TRUE</code> reduces the matching runtime on large datasets, and reduces the amount of nonsensical matches).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Using default `by_sector = TRUE`</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">matched &lt;-<span class="st"> </span><span class="kw"><a href="../reference/match_all_against_all.html">match_all_against_all</a></span>(prep_loanbook, prep_ald)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">matched</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; # A tibble: 64,303 x 3</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;    simpler_name_x simpler_name_y            score</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;                     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;  1 astonmartin    astonmartin               1    </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;  2 astonmartin    avtozaz                   0.681</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;  3 astonmartin    bogdan                    0.480</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;  4 astonmartin    chauto                    0.591</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;  5 astonmartin    chehejia                  0.311</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;  6 astonmartin    chtcauto                  0.455</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  7 astonmartin    dongfenghonda             0.501</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;  8 astonmartin    dongfengluxgen            0.496</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;  9 astonmartin    electricmobilitysolutions 0.456</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; 10 astonmartin    faradayfuture             0.474</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; # … with 64,293 more rows</span></a></code></pre></div>
<p>You may use common dplyr functions to recover all columns from the loanbook dataset and to keep only rows at and above some threshold.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">threshold &lt;-<span class="st"> </span><span class="fl">0.9</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">matched <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(prep_loanbook, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"simpler_name_x"</span> =<span class="st"> "simpler_name"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(score <span class="op">&gt;=</span><span class="st"> </span>threshold)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; # A tibble: 416 x 8</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt;    simpler_name_x   simpler_name_y   score level   id    name      sector source</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;    &lt;chr&gt;            &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;  1 astonmartin      astonmartin          1 ultima… UP23  Aston Ma… autom… loanb…</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;  2 avtozaz          avtozaz              1 ultima… UP25  Avtozaz   autom… loanb…</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  3 bogdan           bogdan               1 ultima… UP36  Bogdan    autom… loanb…</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;  4 chauto           chauto               1 ultima… UP52  Ch Auto   autom… loanb…</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  5 chehejia         chehejia             1 ultima… UP53  Chehejia  autom… loanb…</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;  6 chtcauto         chtcauto             1 ultima… UP58  Chtc Auto autom… loanb…</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;  7 dongfenghonda    dongfenghonda        1 ultima… UP79  Dongfeng… autom… loanb…</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;  8 dongfengluxgen   dongfengluxgen       1 ultima… UP80  Dongfeng… autom… loanb…</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt;  9 electricmobilit… electricmobilit…     1 ultima… UP89  Electric… autom… loanb…</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; 10 faradayfuture    faradayfuture        1 ultima… UP94  Faraday … autom… loanb…</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; # … with 406 more rows</span></a></code></pre></div>
<p>This matching data-frame should be saved and manually verified. To do so, try something like:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(matched, <span class="st">"path/to/save/matches_to_be_verified.csv"</span>)</a></code></pre></div>
<p>and open the .csv in excel/ google sheets/ however you want to edit a spreadsheet. Once open, compare <code>simpler_name_x</code> and <code>simpler_name_y</code> manually, along with the loanbook sector. If you are happy with the match, set the <code>score</code> value to <code>1</code> (Note: Only values of exactly <code>1</code> will be considered valid, all other potential matches will be considered invalidated.)</p>
<p>When you are happy with the match validation:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="st">"path/to/load/verified_matches.csv"</span>)</a></code></pre></div>
<p><strong>Work in progress, next step of analysis it to join in validated matches in order of priority</strong>.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.linkedin.com/in/mauro-lepore/">Mauro Lepore</a>, Klaus Hagedorn, George Harris, Jackson Hoffart, Daan Koopman, Florence Palandri, Evgeny Petrovsky, <a href="https://2degrees-investing.org/">2 Degrees Investing Initiative</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
